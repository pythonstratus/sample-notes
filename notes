# COMMAND ----------
def get_spark_config():
    """
    Display current Spark configuration and environment details safely
    """
    try:
        # Get Spark version safely
        spark_version = spark.version
        
        # Get configuration details safely
        conf_dict = {}
        
        # Use SQL to get some basic configuration info
        runtime_config = spark.sql("SET -v").collect()
        for row in runtime_config:
            conf_dict[row['key']] = row['value']
            
        return {
            "spark_version": spark_version,
            "configuration": conf_dict
        }
    except Exception as e:
        print(f"Error getting configuration: {str(e)}")
        return {
            "spark_version": "Unable to retrieve",
            "configuration": {}
        }

# Display Spark configuration
spark_config = get_spark_config()
print(f"Apache Spark Version: {spark_config['spark_version']}")
print("\nSpark Configuration:")
for key, value in spark_config['configuration'].items():
    print(f"{key}: {value}")

# Alternative simpler approach if you just need version info
print("\nBasic Spark Information:")
print(spark.sparkContext.version)  # Get Spark version directly
