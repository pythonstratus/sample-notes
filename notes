from pyspark.sql.functions import col, when, lit

contract_type = when(
    col("ns0:content.ns1:award.ns1:awardID.ns1:awardContractID").isNotNull(), 
    lit("Award")
).otherwise(
    when(
        col("ns0:content.ns1:IDV").isNotNull(),
        lit("IDV")
    )
).alias("contract_type")

# Add to selected fields 
selected_fields = selected_fields + (contract_type,)
