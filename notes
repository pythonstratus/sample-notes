# First, create a variable with the formatted path
xml_file_path = f"/Volumes/staging/fpds_raw/landing/fpds_output_{datetime.now().strftime('%Y-%m-%d')}.xml"

# Then set this as the default value for the widget
dbutils.widgets.text("file_path", xml_file_path)

# For table_name, keep as is
dbutils.widgets.text("table_name", "staging.fpds_raw.contract_data_test")
dbutils.widgets.text("source_metadata_table_name", "staging.fpds_raw.source_metadata")

# Get the file name from the widget value, not the other way around
file_name = os.path.basename(dbutils.widgets.get("file_path"))
