df = spark.sql("""
SELECT 
    "DMS Extract" as name,
    * EXCEPT (dms_extract_time, prior_four_quarter_average, ratio_of_current_to_prior_4_avg),
    CAST(prior_four_quarter_average AS DECIMAL) as prior_four_quarter_average,
    CAST(ratio_of_current_to_prior_4_avg AS DECIMAL) as ratio_of_current_to_prior_4_avg
FROM msis_mcr_dms.line_item_data
WHERE filing_id = 16096731
    AND dimension_column = "Origination, Warehousing, and Secondary Marketing (1-4 Unit Residential Only)"
    AND line_item = "C340"

UNION ALL

SELECT 
    "Validation" as name,
    * EXCEPT (dms_extract_time, prior_four_quarter_average, ratio_of_current_to_prior_4_avg),
    CAST(prior_four_quarter_average AS DECIMAL) as prior_four_quarter_average,
    CAST(ratio_of_current_to_prior_4_avg AS DECIMAL) as ratio_of_current_to_prior_4_avg
FROM msis_mcr_val.line_item_data
WHERE filing_id = 16096731
    AND dimension_column = "Origination, Warehousing, and Secondary Marketing (1-4 Unit Residential Only)"
    AND line_item = "C340"
""")

# Display the results
df.display()
