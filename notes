spark.sql("""
CREATE OR REPLACE TABLE fpds.contract_data AS
SELECT contract_data.* 
FROM staging.fpds_raw.contract_data AS contract_data
INNER JOIN (
    SELECT max(insert_date) AS max
    FROM staging.fpds_raw.contract_data
) latest_date
ON contract_data.insert_date = latest_date.max
""")
