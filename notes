```python
from pyspark.sql.functions import col, coalesce, lit, when

# Check if claimantProgramCode exists and add conditionally
claimant_program = when(
    col("ns0:content.ns1:award.ns1:claimantProgramCode").isNotNull(),
    col("ns0:content.ns1:award.ns1:claimantProgramCode")
).alias("claimant_program_code")

selected_fields = (
    claimant_program,
    # Rest of your fields...
)

# Remove None/null fields from selection
selected_fields = tuple(field for field in selected_fields if field is not None)
```
