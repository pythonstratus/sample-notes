processed_df = contract_df.select(
    # Basic IDs and Contract Information
    col("ns0:content.ns1:award.ns1:awardID.ns1:awardContractID.ns1:PIID").cast("string").alias("piid"),
    col("ns0:content.ns1:award.ns1:contractData.ns1:claimantProgramCode").cast("string").alias("claimant_program_code"),
    col("ns0:content.ns1:award.ns1:placeOfPerformance.ns1:placeOfPerformanceCongressionalDistrict").cast("long").alias("congressional_district_code"),
    col("ns0:content.ns1:award.ns1:contractData.ns1:contingencyHumanitarianPeacekeepingOperation._value").cast("string").alias("contingency_humanitarian_peacekeeping_operation"),
    col("ns0:content.ns1:award.ns1:productOrServiceInformation.ns1:contractBundling._value").cast("string").alias("contract_bundling"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:contractingOfficerBusinessSizeDetermination._value").cast("string").alias("contracting_officer_business_size_determination"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:countryOfIncorporation._value").cast("string").alias("country_of_incorporation"),
    col("ns0:content.ns1:award.ns1:relevantContractDates.ns1:currentCompletionDate").cast("timestamp").alias("current_completion_date"),
    col("ns0:content.ns1:award.ns1:contractMarketingData.ns1:emailAddress").cast("string").alias("email_address"),
    col("ns0:content.ns1:award.ns1:competition.ns1:fedBizOpps._value").cast("string").alias("fed_biz_opps"),
    col("ns0:content.ns1:award.ns1:contractMarketingData.ns1:feePaidForUseOfService").cast("double").alias("fee_paid_for_use_of_service"),
    col("ns0:content.ns1:award.ns1:competition.ns1:idvNumberOfOffersReceived").cast("long").alias("idv_number_of_offers_received"),
    col("ns0:content.ns1:award.ns1:productOrServiceInformation.ns1:informationTechnologyCommercialItemCategory._value").cast("string").alias("information_technology_commercial_item_category"),
    col("ns0:content.ns1:award.ns1:contractData.ns1:listOfTreasuryAccounts.ns1:treasuryAccount.ns1:initiative._value").cast("string").alias("initiative"),

    # Business Type Indicators
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isAlaskanNativeOwnedCorporationOrFirm").cast("boolean").alias("is_alaskan_native_owned_corporation_or_firm"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isAlaskanNativeServicingInstitution").cast("boolean").alias("is_alaskan_native_servicing_institution"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isAmericanIndianOwned").cast("boolean").alias("is_american_indian_owned"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:minorityOwned.ns1:isAsianPacificAmericanOwnedBusiness").cast("boolean").alias("is_asian_pacific_american_owned_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:minorityOwned.ns1:isBlackAmericanOwnedBusiness").cast("boolean").alias("is_black_american_owned_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isCityLocalGovernment").cast("boolean").alias("is_city_local_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:isCommunityDevelopedCorporationOwnedFirm").cast("boolean").alias("is_community_developed_corporation_owned_firm"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorLineOfBusiness.ns1:isCommunityDevelopmentCorporation").cast("boolean").alias("is_community_development_corporation"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isCountyLocalGovernment").cast("boolean").alias("is_county_local_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorLineOfBusiness.ns1:isDomesticShelter").cast("boolean").alias("is_domestic_shelter"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorCertifications.ns1:isDOTCertifiedDisadvantagedBusinessEnterprise").cast("boolean").alias("is_dot_certified_disadvantaged_business_enterprise"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isEconomicallyDisadvantagedWomenOwnedSmallBusiness").cast("boolean").alias("is_economically_disadvantaged_women_owned_small_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorLineOfBusiness.ns1:isEducationalInstitution").cast("boolean").alias("is_educational_institution"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:federalGovernment.ns1:isFederalGovernment").cast("boolean").alias("is_federal_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:federalGovernment.ns1:isFederalGovernmentAgency").cast("boolean").alias("is_federal_government_agency"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:federalGovernment.ns1:isFederallyFundedResearchAndDevelopmentCorp").cast("boolean").alias("is_federally_funded_research_and_development_corp"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:profitStructure.ns1:isForProfitOrganization").cast("boolean").alias("is_for_profit_organization"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:isForeignGovernment").cast("boolean").alias("is_foreign_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:isForeignOwnedAndLocated").cast("boolean").alias("is_foreign_owned_and_located"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:minorityOwned.ns1:isHispanicAmericanOwnedBusiness").cast("boolean").alias("is_hispanic_american_owned_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorLineOfBusiness.ns1:isHispanicServicingInstitution").cast("boolean").alias("is_hispanic_servicing_institution"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isHistoricallyBlackCollegeOrUniversity").cast("boolean").alias("is_historically_black_college_or_university"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfGovernmentEntity.ns1:isHousingAuthoritiesPublicOrTribal").cast("boolean").alias("is_housing_authorities_public_or_tribal"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isIndianTribe").cast("boolean").alias("is_indian_tribe"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isInterMunicipalLocalGovernment").cast("boolean").alias("is_inter_municipal_local_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfGovernmentEntity.ns1:isInterstateEntity").cast("boolean").alias("is_interstate_entity"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:businessOrOrganizationType.ns1:isInternationalOrganization").cast("boolean").alias("is_international_organization"),
    
    # Joint Venture and Local Government
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isJointVentureEconomicallyDisadvantagedWomenOwnedSmallBusiness").cast("boolean").alias("is_joint_venture_economically_disadvantaged_women_owned_small_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isJointVentureWomenOwnedSmallBusiness").cast("boolean").alias("is_joint_venture_women_owned_small_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isLocalGovernment").cast("boolean").alias("is_local_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isLocalGovernmentOwned").cast("boolean").alias("is_local_government_owned"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isMunicipalityLocalGovernment").cast("boolean").alias("is_municipality_local_government"),
    
    # Native American and Hawaiian
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:minorityOwned.ns1:isNativeAmericanOwnedBusiness").cast("boolean").alias("is_native_american_owned_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isNativeHawaiianOwnedOrganizationOrFirm").cast("boolean").alias("is_native_hawaiian_owned_organization_or_firm"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isNativeHawaiianServicingInstitution").cast("boolean").alias("is_native_hawaiian_servicing_institution"),
    
    # Organization Types
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:profitStructure.ns1:isNonprofitOrganization").cast("boolean").alias("is_nonprofit_organization"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:minorityOwned.ns1:isOtherMinorityOwned").cast("boolean").alias("is_other_minority_owned"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:profitStructure.ns1:isOtherNotForProfitOrganization").cast("boolean").alias("is_other_not_for_profit_organization"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:businessOrOrganizationType.ns1:isPartnershipOrLimitedLiabilityPartnership").cast("boolean").alias("is_partnership_or_limited_liability_partnership"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isPrivateUniversityOrCollege").cast("boolean").alias("is_private_university_or_college"),
    
    # SBA Certifications
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorCertifications.ns1:isSBACertified8AJointVenture").cast("boolean").alias("is_sba_certified_8a_joint_venture"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorCertifications.ns1:isSBACertified8AProgramParticipant").cast("boolean").alias("is_sba_certified_8a_program_participant"),
    col("ns0:content.ns1:award.ns1:vendor



# Read large XML file using Spark XML reader
contract_df = spark.read \
    .format("xml") \
    .option("rootTag", "feed") \
    .option("rowTag", "ns0:entry") \
    .option("valueTag", "_value") \
    .option("attributePrefix", "_") \
    .load("/Volumes/staging/fpds_raw/landing/fpds_output_2025-01-03.xml")

# Extract and transform the data with ALL mapped fields
processed_df = contract_df.select(
    # Basic IDs and Contract Information
    col("ns0:content.ns1:award.ns1:awardID.ns1:awardContractID.ns1:PIID").cast("string").alias("piid"),
    col("ns0:content.ns1:award.ns1:awardID.ns1:awardContractID.ns1:agencyID._value").cast("string").alias("agency_id"),
    col("ns0:content.ns1:award.ns1:awardID.ns1:awardContractID.ns1:agencyID._name").cast("string").alias("agency_name"),
    col("ns0:content.ns1:award.ns1:awardID.ns1:awardContractID.ns1:modNumber").cast("string").alias("mod_number"),
    col("ns0:content.ns1:award.ns1:awardID.ns1:awardContractID.ns1:transactionNumber").cast("string").alias("transaction_number"),

    # Contract Details
    col("ns0:content.ns1:award.ns1:contractData.ns1:claimantProgramCode").cast("string").alias("claimant_program_code"),
    col("ns0:content.ns1:award.ns1:placeOfPerformance.ns1:placeOfPerformanceCongressionalDistrict").cast("long").alias("congressional_district_code"),
    col("ns0:content.ns1:award.ns1:contractData.ns1:contingencyHumanitarianPeacekeepingOperation._value").cast("string").alias("contingency_humanitarian_peacekeeping_operation"),
    col("ns0:content.ns1:award.ns1:productOrServiceInformation.ns1:contractBundling._value").cast("string").alias("contract_bundling"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:contractingOfficerBusinessSizeDetermination._value").cast("string").alias("contracting_officer_business_size_determination"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:countryOfIncorporation._value").cast("string").alias("country_of_incorporation"),
    col("ns0:content.ns1:award.ns1:relevantContractDates.ns1:currentCompletionDate").cast("timestamp").alias("current_completion_date"),
    col("ns0:content.ns1:award.ns1:contractMarketingData.ns1:emailAddress").cast("string").alias("email_address"),
    col("ns0:content.ns1:award.ns1:competition.ns1:fedBizOpps._value").cast("string").alias("fed_biz_opps"),
    col("ns0:content.ns1:award.ns1:contractMarketingData.ns1:feePaidForUseOfService").cast("double").alias("fee_paid_for_use_of_service"),
    col("ns0:content.ns1:award.ns1:competition.ns1:idvNumberOfOffersReceived").cast("long").alias("idv_number_of_offers_received"),
    col("ns0:content.ns1:award.ns1:productOrServiceInformation.ns1:informationTechnologyCommercialItemCategory._value").cast("string").alias("information_technology_commercial_item_category"),
    col("ns0:content.ns1:award.ns1:contractData.ns1:listOfTreasuryAccounts.ns1:treasuryAccount.ns1:initiative._value").cast("string").alias("initiative"),

    # Business Type Indicators
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isAlaskanNativeOwnedCorporationOrFirm").cast("boolean").alias("is_alaskan_native_owned_corporation_or_firm"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isAlaskanNativeServicingInstitution").cast("boolean").alias("is_alaskan_native_servicing_institution"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isAmericanIndianOwned").cast("boolean").alias("is_american_indian_owned"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:minorityOwned.ns1:isAsianPacificAmericanOwnedBusiness").cast("boolean").alias("is_asian_pacific_american_owned_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:minorityOwned.ns1:isBlackAmericanOwnedBusiness").cast("boolean").alias("is_black_american_owned_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isCityLocalGovernment").cast("boolean").alias("is_city_local_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:isCommunityDevelopedCorporationOwnedFirm").cast("boolean").alias("is_community_developed_corporation_owned_firm"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorLineOfBusiness.ns1:isCommunityDevelopmentCorporation").cast("boolean").alias("is_community_development_corporation"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isCountyLocalGovernment").cast("boolean").alias("is_county_local_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorLineOfBusiness.ns1:isDomesticShelter").cast("boolean").alias("is_domestic_shelter"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorCertifications.ns1:isDOTCertifiedDisadvantagedBusinessEnterprise").cast("boolean").alias("is_dot_certified_disadvantaged_business_enterprise"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isEconomicallyDisadvantagedWomenOwnedSmallBusiness").cast("boolean").alias("is_economically_disadvantaged_women_owned_small_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorLineOfBusiness.ns1:isEducationalInstitution").cast("boolean").alias("is_educational_institution"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:federalGovernment.ns1:isFederalGovernment").cast("boolean").alias("is_federal_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:federalGovernment.ns1:isFederalGovernmentAgency").cast("boolean").alias("is_federal_government_agency"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:federalGovernment.ns1:isFederallyFundedResearchAndDevelopmentCorp").cast("boolean").alias("is_federally_funded_research_and_development_corp"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:profitStructure.ns1:isForProfitOrganization").cast("boolean").alias("is_for_profit_organization"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:isForeignGovernment").cast("boolean").alias("is_foreign_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:isForeignOwnedAndLocated").cast("boolean").alias("is_foreign_owned_and_located"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:minorityOwned.ns1:isHispanicAmericanOwnedBusiness").cast("boolean").alias("is_hispanic_american_owned_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorLineOfBusiness.ns1:isHispanicServicingInstitution").cast("boolean").alias("is_hispanic_servicing_institution"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isHistoricallyBlackCollegeOrUniversity").cast("boolean").alias("is_historically_black_college_or_university"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfGovernmentEntity.ns1:isHousingAuthoritiesPublicOrTribal").cast("boolean").alias("is_housing_authorities_public_or_tribal"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isIndianTribe").cast("boolean").alias("is_indian_tribe"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isInterMunicipalLocalGovernment").cast("boolean").alias("is_inter_municipal_local_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfGovernmentEntity.ns1:isInterstateEntity").cast("boolean").alias("is_interstate_entity"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:businessOrOrganizationType.ns1:isInternationalOrganization").cast("boolean").alias("is_international_organization"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isJointVentureEconomicallyDisadvantagedWomenOwnedSmallBusiness").cast("boolean").alias("is_joint_venture_economically_disadvantaged_women_owned_small_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isJointVentureWomenOwnedSmallBusiness").cast("boolean").alias("is_joint_venture_women_owned_small_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isLocalGovernment").cast("boolean").alias("is_local_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isLocalGovernmentOwned").cast("boolean").alias("is_local_government_owned"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isMunicipalityLocalGovernment").cast("boolean").alias("is_municipality_local_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:minorityOwned.ns1:isNativeAmericanOwnedBusiness").cast("boolean").alias("is_native_american_owned_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isNativeHawaiianOwnedOrganizationOrFirm").cast("boolean").alias("is_native_hawaiian_owned_organization_or_firm"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isNativeHawaiianServicingInstitution").cast("boolean").alias("is_native_hawaiian_servicing_institution"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:profitStructure.ns1:isNonprofitOrganization").cast("boolean").alias("is_nonprofit_organization"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:minorityOwned.ns1:isOtherMinorityOwned").cast("boolean").alias("is_other_minority_owned"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:profitStructure.ns1:isOtherNotForProfitOrganization").cast("boolean").alias("is_other_not_for_profit_organization"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:businessOrOrganizationType.ns1:isPartnershipOrLimitedLiabilityPartnership").cast("boolean").alias("is_partnership_or_limited_liability_partnership"),
    
    # Educational and SBA Certifications
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isPrivateUniversityOrCollege").cast("boolean").alias("is_private_university_or_college"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorCertifications.ns1:isSBACertified8AJointVenture").cast("boolean").alias("is_sba_certified_8a_joint_venture"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorCertifications.ns1:isSBACertified8AProgramParticipant").cast("boolean").alias("is_sba_certified_8a_program_participant"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorCertifications.ns1:isSBACertifiedHUBZone").cast("boolean").alias("is_sba_certified_hubzone"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorCertifications.ns1:isSBACertifiedSmallDisadvantagedBusiness").cast("boolean").alias("is_sba_certified_small_disadvantaged_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isSchoolDistrictLocalGovernment").cast("boolean").alias("is_school_district_local_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isSchoolOfForestry").cast("boolean").alias("is_school_of_forestry"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorCertifications.ns1:isSelfCertifiedHUBZoneJointVenture").cast("boolean").alias("is_self_certified_hubzone_joint_venture"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorCertifications.ns1:isSelfCertifiedSmallDisadvantagedBusiness").cast("boolean").alias("is_self_certified_small_disadvantaged_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isServiceRelatedDisabledVeteranOwnedBusiness").cast("boolean").alias("is_service_related_disabled_veteran_owned_business"),
    
    # Business Structure Indicators
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:businessOrOrganizationType.ns1:isSmallAgriculturalCooperative").cast("boolean").alias("is_small_agricultural_cooperative"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:businessOrOrganizationType.ns1:isSolePropreitorship").cast("boolean").alias("is_sole_propreitorship"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isStateControlledInstitutionofHigherLearning").cast("boolean").alias("is_state_controlled_institution_of_higher_learning"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:isStateGovernment").cast("boolean").alias("is_state_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:minorityOwned.ns1:isSubContinentAsianAmericanOwnedBusiness").cast("boolean").alias("is_sub_continent_asian_american_owned_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:isSubchapterSCorporation").cast("boolean").alias("is_subchapter_s_corporation"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:localGovernment.ns1:isTownshipLocalGovernment").cast("boolean").alias("is_township_local_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isTribalCollege").cast("boolean").alias("is_tribal_college"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:isTribalGovernment").cast("boolean").alias("is_tribal_government"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isTriballyOwnedFirm").cast("boolean").alias("is_tribally_owned_firm"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorBusinessTypes.ns1:businessOrOrganizationType.ns1:isUSGovernmentEntity").cast("boolean").alias("is_us_government_entity"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorSocioEconomicIndicators.ns1:isVerySmallBusiness").cast("boolean").alias("is_very_small_business"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:typeOfEducationalEntity.ns1:isVeterinaryCollege").cast("boolean").alias("is_veterinary_college"),
    
    # Dates and Location Information
    col("ns0:content.ns1:award.ns1:relevantContractDates.ns1:lastDateToOrder").cast("timestamp").alias("last_date_to_order"),
    col("ns0:content.ns1:award.ns1:legislativeMandates.ns1:listOfAdditionalReportingValues.ns1:additionalReportingValue._value").cast("string").alias("list_of_additional_reporting_values"),
    col("ns0:content.ns1:award.ns1:competition.ns1:localAreaSetAside._value").cast("string").alias("local_area_set_aside"),
    col("ns0:content.ns1:award.ns1:placeOfPerformance.ns1:placeOfPerformanceCongressionalDistrict").cast("long").alias("place_of_performance_congressional_district"),
    col("ns0:content.ns1:award.ns1:placeOfPerformance.ns1:principalPlaceOfPerformance.ns1:countryCode._value").cast("string").alias("place_of_performance_country_code"),
    col("ns0:content.ns1:award.ns1:placeOfPerformance.ns1:placeOfPerformanceZIPCode._value").cast("string").alias("place_of_performance_zip_code"),
    
    # Product and Contract Information
    col("ns0:content.ns1:award.ns1:productOrServiceInformation.ns1:principalNAICSCode._value").cast("long").alias("principal_naics_code"),
    col("ns0:content.ns1:award.ns1:productOrServiceInformation.ns1:productOrServiceCode._value").cast("string").alias("product_or_service_code"),
    col("ns0:content.ns1:award.ns1:productOrServiceInformation.ns1:productOrServiceCode._description").cast("string").alias("product_or_service_code_description"),
    col("ns0:content.ns1:award.ns1:competition.ns1:reasonNotCompeted._value").cast("string").alias("reason_not_competed"),
    
    # Vendor Relationship Information
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorRelationshipWithFederalGovernment.ns1:receivesContracts").cast("boolean").alias("receives_contracts"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorRelationshipWithFederalGovernment.ns1:receivesContractsAndGrants").cast("boolean").alias("receives_contracts_and_grants"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorRelationshipWithFederalGovernment.ns1:receivesGrants").cast("boolean").alias("receives_grants"),
    col("ns0:content.ns1:award.ns1:competition.ns1:smallBusinessCompetitivenessDemonstrationProgram").cast("boolean").alias("small_business_competitiveness_demonstration_program"),
    
    # Additional Contract Details
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorOrganizationFactors.ns1:stateOfIncorporation._value").cast("string").alias("state_of_incorporation"),
    col("ns0:content.ns1:award.ns1:competition.ns1:statutoryExceptionToFairOpportunity._value").cast("string").alias("statutory_exception_to_fair_opportunity"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorLocation.ns1:streetAddress2").cast("string").alias("street_address3"),
    col("ns0:content.ns1:award.ns1:preferencePrograms.ns1:subcontractPlan._value").cast("string").alias("subcontract_plan"),
    col("ns0:content.ns1:award.ns1:contractMarketingData.ns1:typeOfFeeForUseOfService._value").cast("string").alias("type_of_fee_for_use_of_service"),
    col("ns0:content.ns1:award.ns1:contractData.ns1:typeOfIDC._value").cast("string").alias("type_of_idc"),
    col("ns0:content.ns1:award.ns1:productOrServiceInformation.ns1:useOfEPADesignatedProducts._value").cast("string").alias("use_of_epa_designated_products"),
    
    # Vendor Site Information
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorAlternateSiteCode").cast("string").alias("vendor_alternate_site_code"),
    col("ns0:content.ns1:award.ns1:vendor.ns1:vendorSiteDetails.ns1:vendorLocation.ns1:ZIPCode._value").cast("string").alias("vendor_site_code"),
    col("ns0:content.ns1:award.ns1:contractMarketingData.ns1:whoCanUse").cast("string").alias("who_can_use")
)
